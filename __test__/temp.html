<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        // 字符分隔符
        const charSep = ''
        // []表达式正则
        const quotesReg = /['"[\]]/

        const parser = () => {
            const setComplexState = (memory, state) => memory.isComplex = state
            const clearExpression = memory => memory.expression.length = 0

            const memory = {
                isComplex: false,
                expression: [],
            }

            return (pathSet, sep = '.') => {
                const paths = pathSet.split(charSep)
                const length = paths.length
                return paths.reduce((paths, char, index) => {
                    if (char === '[') {
                        setComplexState(memory, true)
                    } else if (char === ']') {
                        setComplexState(memory, false)
                    }

                    if (!memory.isComplex && char !== sep || memory.isComplex && !quotesReg.test(char)) {
                        memory.expression.push(char)
                    }

                    if (!memory.isComplex && char === sep || !memory.isComplex && char !== sep && index === length - 1 || char === '[' || char === ']') {
                        const newPaths = paths.concat(memory.expression.join(charSep))
                        clearExpression(memory)
                        return newPaths
                    }
                    return paths
                }, [])
            }
        }

        console.log(parser()(`a['b.c'][2].d.e`))

    </script>
</head>
<body>

</body>
</html>